import{d as B,a as b,r as E,w as N,C as W,D as P,z as i}from"./CS_v0reC.js";import{f as q,p as v,B as L,C as M,D as $,E as z,I as R,F as I,G as p,H as A,J as F}from"./CPIMTh_-.js";const[G,c]=q("notice-bar"),H={text:String,mode:String,color:String,delay:v(1),speed:v(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var V=B({name:G,props:H,emits:["close","replay"],setup(e,{emit:m,slots:a}){let l=0,o=0,h;const d=b(),u=b(),t=E({show:!0,offset:0,duration:0}),y=()=>{if(a["left-icon"])return a["left-icon"]();if(e.leftIcon)return i(R,{class:c("left-icon"),name:e.leftIcon},null)},k=()=>{if(e.mode==="closeable")return"cross";if(e.mode==="link")return"arrow"},x=n=>{e.mode==="closeable"&&(t.show=!1,m("close",n))},S=()=>{if(a["right-icon"])return a["right-icon"]();const n=k();if(n)return i(R,{name:n,class:c("right-icon"),onClick:x},null)},C=()=>{t.offset=l,t.duration=0,A(()=>{p(()=>{t.offset=-o,t.duration=(o+l)/+e.speed,m("replay")})})},D=()=>{const n=e.scrollable===!1&&!e.wrapable,s={transform:t.offset?`translateX(${t.offset}px)`:"",transitionDuration:`${t.duration}s`};return i("div",{ref:d,role:"marquee",class:c("wrap")},[i("div",{ref:u,style:s,class:[c("content"),{"van-ellipsis":n}],onTransitionend:C},[a.default?a.default():e.text])])},r=()=>{const{delay:n,speed:s,scrollable:f}=e,T=F(n)?+n*1e3:0;l=0,o=0,t.offset=0,t.duration=0,clearTimeout(h),h=setTimeout(()=>{if(!d.value||!u.value||f===!1)return;const w=I(d).width,g=I(u).width;(f||g>w)&&p(()=>{l=w,o=g,t.offset=-o,t.duration=o/+s})},T)};return L(r),M(r),$("pageshow",r),z({reset:r}),N(()=>[e.text,e.scrollable],r),()=>{const{color:n,wrapable:s,background:f}=e;return W(i("div",{role:"alert",class:c({wrapable:s}),style:{color:n,background:f}},[y(),D(),S()]),[[P,t.show]])}}});export{V as s};
